<!DOCTYPE html>
<html>
<head>
    <title>ATDD</title>

    <link href="Metro-UI-CSS-master/docs/css/metro.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/metro-icons.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/metro-responsive.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/metro-schemes.css" rel="stylesheet">

    <link href="Metro-UI-CSS-master/docs/css/docs.css" rel="stylesheet">

    <script src="Metro-UI-CSS-master/docs/js/jquery-2.1.3.min.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/metro.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/docs.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/prettify/run_prettify.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/ga.js"></script>
	<script src="select2-4.0.0-beta.2/dist/js/select2.min.js"></script>
	
	
	<meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
	
	
	
	
	<style>
			
		#map { 
			position:absolute; 
			top:0;
			bottom:0; 
			width:75%; 
		}
		
		#nav {
			position: absolute;
			right: 0;
		    background-color:#eeeeee;
			width:25%;
			height:50%;
			border: 0.5px solid #eeeeee;
		}
	
		#details{
			position: absolute;
			bottom: 0;
			right: 0;
			background-color: black;
			width:25%;
			height:50%;
			color: white;
			text-align: center;
			border: 0.5px solid black;
			
		}	
	</style>
	
	<script> //importing all data
			//store location, latitude, and longtitude data 
			//(Station is for reference purpose only)
			var locationSet = [];
			//store species name for all detection
			var speciesSet = [];
			
			//parsing "location data" into an array of objects (row == object)
			d3.csv("Location.csv", function(data) {
				//type coversion for field that is integer
				data.forEach(function(d) {
					d.Lat = +d.Lat;
					d.Long = +d.Long;
				});//end: type coversion
				//pass array to locationSet
				locationSet = data;
			});//end parsing "Location data"
			
			//parsing "Species data" into an array of objects (row == object)
			d3.csv("Species.csv", function(data) {
				//pass array to locationSet
				speciesSet = data;
			});//end parsing "Species data"
			alert("Hello");
			//var data = [{ id: 0, text: 'enhancement' }, { id: 1, text: 'bug' }, { id: 2, text: 'duplicate' }, { id: 3, text: 'invalid' }, { id: 4, text: 'wontfix' }];
		
			var speciesOptions = []; 
			console.log("First item in speciesSet: " + speciesSet[0].species_name);
			
			for(i = 0; i < speciesSet.length; i++){
				speciesOptions[i] = {id: i, text: speciesSet[i].species_name};
			}
			//console.log("First item in speciesSet: " + speciesSet[0]);
			//console.log("First item in speciesOptions : " + speciesOptions[0]);
			
			$(document).ready(function() {
				$(".slct1").select2({
				placeholder: "Select species.",
				allowClear: true,
				data: speciesOptions
				});
			});
			
			$(document).ready(function() {
				$(".slct1").select2()
					.find(":selected")
					.data("id");
			});
			
			
			//.$(".slct1").select2().find(":selected").data("id");
		</script>


</head>
<body>

	
	<div id = "map">
		<script>
			//Initializing map to (33.40, -118.20)
			L.mapbox.accessToken = 'pk.eyJ1IjoibWdsbW9udGVzIiwiYSI6ImNpbDhsZDV1YjBkNHd1MG0wd3Q3MnZpZmkifQ.6JR0V9EtTAhUeUi_tL4RJQ';
			var map = L.mapbox.map('map', 'mapbox.satellite')
				.setView([33.40, -118.20], 9);//33.40, -118.20
			
			// Setup our svg layer that we can manipulate with d3
			var svg = d3.select(map.getPanes().overlayPane)
			  .append("svg");
			var g = svg.append("g").attr("class", "leaflet-zoom-hide");
    
			//what does this function do??
			function project(ll) {
			  // our data came from csv, make it Leaflet friendly
			  //var a = [+ll.lat, +ll.lon]; 
			  // convert it to pixel coordinates
			  var point = map.latLngToLayerPoint(L.latLng(ll))
			  return point;
			}
  
    d3.csv("detections.csv", function(err, lol) {
	
	//what is this for?
	console.log(lol[0]);
	
	//do we need another variable for point? or could we use detection array that was already parse.
	var points = [];
	
	//initializing the points array
	for(i = 0; i < lol.length; i++)
	{
		points[i] = {lat: lol[i].Latitude, lng: lol[i].Longitude};
	}
	
	console.log(points[0]);
	
	//make cirle at with the point data(point data contain lat and long)
    var dots = g.selectAll("circle.dot")
		.data(points)

    dots.enter().append("circle").classed("dot", true)
      .attr("r", 1)
      .style({
        fill: "#0082a3",
        "fill-opacity": 0.6,
        stroke: "#004d60",
        "stroke-width": 1
      })
      .transition().duration(1000)
      .attr("r", 6);
    ///////////////////////////////////////////////////////////////
      
      function render() {
        // We need to reposition our SVG and our containing group when the map
        // repositions via zoom or pan
        // https://github.com/zetter/voronoi-maps/blob/master/lib/voronoi_map.js
        var bounds = map.getBounds();
        var topLeft = map.latLngToLayerPoint(bounds.getNorthWest());
        var bottomRight = map.latLngToLayerPoint(bounds.getSouthEast());
        svg.style("width", map.getSize().x + "px")
          .style("height", map.getSize().y + "px")
          .style("left", topLeft.x + "px")
          .style("top", topLeft.y + "px");
        g.attr("transform", "translate(" + -topLeft.x + "," + -topLeft.y + ")");

        // We reproject our data with the updated projection from leaflet
        g.selectAll("circle.dot")
        .attr({
          cx: function(d) { return project(d).x},
          cy: function(d) { return project(d).y},
        })
      }

      // re-render our visualization whenever the view changes
      map.on("viewreset", function() {
        render()
      })
      map.on("move", function() {
        render()
      })

      // render our initial visualization
      render()
    })
		</script>
	</div>

	<!--input requirement section-->
	<div id = "nav">
		<div class = "grid">
			<div class = "row cells2">
				<!--species drop downmenu-->
				<div class = "cell">
				
				
				
						<select class = "slct1 full-size" >
			
	
						</select>
						
						
						
						
				</div>
				<!--individual selection dropdown menu-->
				<div class = "cell">
					<div class="input-control full-size" data-role="select" data-placeholder="Select individual." data-allow-clear="true">
						<select class="full-size">
			
						</select>
					</div>

				</div>
			</div>
		</div>
		<!--radio buttons-->
		<div data-role="group" data-group-type="one-state">
			<button class="button">All</button>
			<button class="button">Individual</button>
		</div>
		<!--start date and end date datepicker calendars-->
		<div class="grid">
			<div class="row cells2">
				<div class="cell">
					<h5>Start Date</h5>
					<div class="input-control text" data-role="datepicker" data-date="1972-12-21" data-format="mmmm d, yyyy">
						<input type="text">
						<button class="button"><span class="mif-calendar"></span></button>
					</div>
				</div>
				<div class="cell">
					<h5>End Date</h5>
					<div class="input-control text" data-role="datepicker" data-date="1972-12-21" data-format="mmmm d, yyyy">
						<input type="text">
						<button class="button"><span class="mif-calendar"></span></button>
					</div>
				</div>
			</div>
		</div>
	</div>
	

	<div id = "details">
		<h1>Details go here.</h1>
	</div>



</body>
</html>