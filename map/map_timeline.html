<!DOCTYPE html>
<html>
<head>
    <title>ATDD</title>

	<meta charset="utf-8">
	

    <link href="Metro-UI-CSS-master/docs/css/metro.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/metro-icons.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/metro-responsive.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/metro-schemes.css" rel="stylesheet">
    <link href="Metro-UI-CSS-master/docs/css/docs.css" rel="stylesheet">
	<link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
	<link href="leaflet.timeline.min.css" rel="stylesheet">
	
	

    <script src="Metro-UI-CSS-master/docs/js/jquery-2.1.3.min.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/metro.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/docs.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/prettify/run_prettify.js"></script>
    <script src="Metro-UI-CSS-master/docs/js/ga.js"></script>
	<script src="select2-4.0.0-beta.2/dist/js/select2.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
	<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	<script src="leaflet.timeline.min.js"></script>
	

	<style>
			
		#map { 
			position:absolute; 
			top:0;
			bottom:0; 
			width:100%; 
		}
		
	</style>
</head>

<body>
	<div id = "map">
		<script>
		
			//Setting up the map layer
			var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
			var osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">' +
			'OpenStreetMap</a> contributors';
			var osm = L.tileLayer(osmUrl, {
				maxZoom: 18,
				attribution: osmAttrib,
				noWrap: true
			});

			var map = L.map('map', {
				layers: [osm],
				center: new L.LatLng(0,0),
				zoom: 7,
				maxBounds: [[33.40, -118.20], [33.40, -118.20]]
			});
			//End: map layer
			
			
			//walk thourgh data,
			//add timeline and timelineControl to the map
			function eqfeed_callback(data) {
	
						var time;
						var startTime;
						var getInterval = function(quake) {
							time = quake.properties["Date and Time (UTC)"];
							time = time.concat(":00");
							startTime = new Date(time);
							console.log(startTime + " " + startTime.getTime());
							return {
								start: startTime.getTime(),
								end:   startTime.getTime() + 160000000
							};
						};
					
				//Setting up timeLineControl
				var timelineControl = L.timelineSliderControl({
					formatOutput: function(date) {
						return new Date(date).toString();
					}
				});
				//End: timeLineControl
				
				//Setting up timeLine
				var timeline = L.timeline(data, {
					getInterval: getInterval,
					pointToLayer: function(data, latlng){
						var hue_min = 120;
						var hue_max = 0;
						//var hue = data.properties.mag / 10 * (hue_max - hue_min) + hue_min;
						var hue = 250;
						return L.circleMarker(latlng, {
						  //radius: data.properties.mag * 3,
						  radius: 25,
						  color: "hsl("+hue+", 100%, 50%)",
						  fillColor: "hsl("+hue+", 100%, 50%)"
						}).bindPopup('hello');
					}
				});
				//End: timeline
				
				//add timelineControl and timeline to the map
				timelineControl.addTo(map);
				timelineControl.addTimelines(timeline);
				timeline.addTo(map);
			}//End eqfeed_callback
		</script>
		<script src="detection-1000.geojson"></script>
	</div>
</body>
</html>